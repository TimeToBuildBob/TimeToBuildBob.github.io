<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pomodoro Timer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #1a1a2e;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #fff;
        }

        .widget {
            background: #16213e;
            border-radius: 24px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
            text-align: center;
            min-width: 320px;
        }

        .widget h1 {
            font-size: 1.5rem;
            font-weight: 500;
            margin-bottom: 30px;
            color: #e94560;
        }

        .mode-toggle {
            display: flex;
            gap: 8px;
            justify-content: center;
            margin-bottom: 30px;
        }

        .mode-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: #aaa;
            padding: 10px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.3s ease;
        }

        .mode-btn:hover {
            background: rgba(255, 255, 255, 0.15);
            color: #fff;
        }

        .mode-btn.active {
            background: #e94560;
            color: #fff;
        }

        .timer-container {
            position: relative;
            width: 240px;
            height: 240px;
            margin: 0 auto 30px;
        }

        .progress-ring {
            transform: rotate(-90deg);
        }

        .progress-ring__circle-bg {
            stroke: rgba(255, 255, 255, 0.1);
        }

        .progress-ring__circle {
            stroke: #e94560;
            stroke-linecap: round;
            transition: stroke-dashoffset 0.5s ease;
        }

        .timer-display {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 3.5rem;
            font-weight: 300;
            font-variant-numeric: tabular-nums;
            letter-spacing: 2px;
        }

        .timer-display.flash {
            animation: flash 0.5s ease-in-out 3;
        }

        @keyframes flash {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; color: #e94560; }
        }

        .controls {
            display: flex;
            gap: 12px;
            justify-content: center;
        }

        .control-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: #fff;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.5rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .control-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.05);
        }

        .control-btn.primary {
            background: #e94560;
            width: 80px;
            height: 80px;
        }

        .control-btn.primary:hover {
            background: #d63850;
        }

        .status {
            margin-top: 20px;
            font-size: 0.9rem;
            color: #888;
        }

        /* SVG icons inline */
        .icon {
            width: 24px;
            height: 24px;
            fill: currentColor;
        }

        .control-btn.primary .icon {
            width: 32px;
            height: 32px;
        }
    </style>
</head>
<body>
    <div class="widget">
        <h1>Pomodoro Timer</h1>

        <div class="mode-toggle">
            <button class="mode-btn active" data-mode="pomodoro" data-duration="25">Pomodoro</button>
            <button class="mode-btn" data-mode="short" data-duration="5">Short Break</button>
            <button class="mode-btn" data-mode="long" data-duration="15">Long Break</button>
        </div>

        <div class="timer-container">
            <svg class="progress-ring" width="240" height="240">
                <circle class="progress-ring__circle-bg"
                    cx="120" cy="120" r="108"
                    fill="transparent"
                    stroke-width="8"/>
                <circle class="progress-ring__circle"
                    cx="120" cy="120" r="108"
                    fill="transparent"
                    stroke-width="8"
                    stroke-dasharray="678.58"
                    stroke-dashoffset="0"/>
            </svg>
            <div class="timer-display" id="timer">25:00</div>
        </div>

        <div class="controls">
            <button class="control-btn" id="resetBtn" title="Reset">
                <svg class="icon" viewBox="0 0 24 24">
                    <path d="M17.65 6.35A7.958 7.958 0 0012 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0112 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/>
                </svg>
            </button>
            <button class="control-btn primary" id="playPauseBtn" title="Start">
                <svg class="icon play-icon" viewBox="0 0 24 24">
                    <path d="M8 5v14l11-7z"/>
                </svg>
                <svg class="icon pause-icon" viewBox="0 0 24 24" style="display: none;">
                    <path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/>
                </svg>
            </button>
            <button class="control-btn" id="skipBtn" title="Skip">
                <svg class="icon" viewBox="0 0 24 24">
                    <path d="M6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z"/>
                </svg>
            </button>
        </div>

        <div class="status" id="status">Ready to focus</div>
    </div>

    <script>
        const timerDisplay = document.getElementById('timer');
        const playPauseBtn = document.getElementById('playPauseBtn');
        const resetBtn = document.getElementById('resetBtn');
        const skipBtn = document.getElementById('skipBtn');
        const statusEl = document.getElementById('status');
        const progressCircle = document.querySelector('.progress-ring__circle');
        const modeBtns = document.querySelectorAll('.mode-btn');
        const playIcon = playPauseBtn.querySelector('.play-icon');
        const pauseIcon = playPauseBtn.querySelector('.pause-icon');

        const CIRCUMFERENCE = 2 * Math.PI * 108; // 678.58
        progressCircle.style.strokeDasharray = CIRCUMFERENCE;

        let timeRemaining = 25 * 60;
        let totalTime = 25 * 60;
        let isRunning = false;
        let intervalId = null;
        let currentMode = 'pomodoro';

        const modes = {
            pomodoro: { duration: 25, status: 'Time to focus!' },
            short: { duration: 5, status: 'Short break - relax!' },
            long: { duration: 15, status: 'Long break - recharge!' }
        };

        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        }

        function updateDisplay() {
            timerDisplay.textContent = formatTime(timeRemaining);
            const progress = (totalTime - timeRemaining) / totalTime;
            const offset = CIRCUMFERENCE * (1 - progress);
            progressCircle.style.strokeDashoffset = offset;
        }

        function updateIcons() {
            if (isRunning) {
                playIcon.style.display = 'none';
                pauseIcon.style.display = 'block';
                playPauseBtn.title = 'Pause';
            } else {
                playIcon.style.display = 'block';
                pauseIcon.style.display = 'none';
                playPauseBtn.title = 'Start';
            }
        }

        function start() {
            if (timeRemaining <= 0) return;
            isRunning = true;
            updateIcons();
            statusEl.textContent = modes[currentMode].status;

            intervalId = setInterval(() => {
                timeRemaining--;
                updateDisplay();

                if (timeRemaining <= 0) {
                    complete();
                }
            }, 1000);
        }

        function pause() {
            isRunning = false;
            updateIcons();
            clearInterval(intervalId);
            statusEl.textContent = 'Paused';
        }

        function reset() {
            pause();
            timeRemaining = totalTime;
            updateDisplay();
            statusEl.textContent = 'Ready to focus';
        }

        function complete() {
            pause();
            timerDisplay.classList.add('flash');
            statusEl.textContent = 'Time\'s up!';

            // Play notification sound if available
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();

                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);

                oscillator.frequency.value = 800;
                oscillator.type = 'sine';
                gainNode.gain.value = 0.3;

                oscillator.start();
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                oscillator.stop(audioContext.currentTime + 0.5);
            } catch (e) {
                // Audio not supported, visual flash is the fallback
            }

            setTimeout(() => {
                timerDisplay.classList.remove('flash');
            }, 1500);
        }

        function setMode(mode) {
            currentMode = mode;
            totalTime = modes[mode].duration * 60;
            timeRemaining = totalTime;

            modeBtns.forEach(btn => {
                btn.classList.toggle('active', btn.dataset.mode === mode);
            });

            pause();
            updateDisplay();
            statusEl.textContent = 'Ready to focus';
        }

        function skip() {
            // Move to next mode
            const modeOrder = ['pomodoro', 'short', 'pomodoro', 'long'];
            const currentIndex = modeOrder.indexOf(currentMode);
            const nextMode = modeOrder[(currentIndex + 1) % modeOrder.length];
            setMode(nextMode);
        }

        // Event listeners
        playPauseBtn.addEventListener('click', () => {
            if (isRunning) {
                pause();
            } else {
                start();
            }
        });

        resetBtn.addEventListener('click', reset);
        skipBtn.addEventListener('click', skip);

        modeBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                setMode(btn.dataset.mode);
            });
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space') {
                e.preventDefault();
                playPauseBtn.click();
            } else if (e.code === 'KeyR') {
                resetBtn.click();
            } else if (e.code === 'KeyS') {
                skipBtn.click();
            }
        });

        // Initial display
        updateDisplay();
    </script>
</body>
</html>
