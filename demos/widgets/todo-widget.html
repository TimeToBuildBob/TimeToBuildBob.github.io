<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Todo List Widget</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      background: #1a1a2e;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      padding: 20px;
    }

    .todo-widget {
      background: #16213e;
      border-radius: 16px;
      padding: 24px;
      width: 100%;
      min-width: 300px;
      max-width: 500px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
    }

    .todo-header {
      margin-bottom: 20px;
    }

    .todo-header h1 {
      color: #e94560;
      font-size: 1.5rem;
      font-weight: 600;
      margin-bottom: 16px;
    }

    .todo-input-container {
      display: flex;
      gap: 10px;
    }

    .todo-input {
      flex: 1;
      background: #1a1a2e;
      border: 2px solid #0f3460;
      border-radius: 12px;
      padding: 12px 16px;
      color: #eee;
      font-size: 1rem;
      outline: none;
      transition: border-color 0.2s ease;
    }

    .todo-input:focus {
      border-color: #e94560;
    }

    .todo-input::placeholder {
      color: #666;
    }

    .add-btn {
      background: #e94560;
      border: none;
      border-radius: 12px;
      padding: 12px 20px;
      color: white;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .add-btn:hover {
      background: #ff6b6b;
      transform: translateY(-2px);
    }

    .add-btn:active {
      transform: translateY(0);
    }

    .todo-filters {
      display: flex;
      gap: 8px;
      margin: 20px 0;
      flex-wrap: wrap;
    }

    .filter-btn {
      background: #1a1a2e;
      border: 2px solid #0f3460;
      border-radius: 20px;
      padding: 8px 16px;
      color: #888;
      font-size: 0.875rem;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .filter-btn:hover {
      border-color: #e94560;
      color: #e94560;
    }

    .filter-btn.active {
      background: #e94560;
      border-color: #e94560;
      color: white;
    }

    .todo-list {
      list-style: none;
      max-height: 300px;
      overflow-y: auto;
    }

    .todo-list::-webkit-scrollbar {
      width: 6px;
    }

    .todo-list::-webkit-scrollbar-track {
      background: #1a1a2e;
      border-radius: 3px;
    }

    .todo-list::-webkit-scrollbar-thumb {
      background: #0f3460;
      border-radius: 3px;
    }

    .todo-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 14px;
      background: #1a1a2e;
      border-radius: 10px;
      margin-bottom: 8px;
      animation: slideIn 0.3s ease;
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateX(-20px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    .todo-item.completing {
      animation: complete 0.3s ease forwards;
    }

    @keyframes complete {
      to {
        opacity: 0.6;
      }
    }

    .todo-item.deleting {
      animation: slideOut 0.3s ease forwards;
    }

    @keyframes slideOut {
      to {
        opacity: 0;
        transform: translateX(20px);
        height: 0;
        padding: 0;
        margin: 0;
      }
    }

    .todo-checkbox {
      appearance: none;
      width: 22px;
      height: 22px;
      border: 2px solid #0f3460;
      border-radius: 6px;
      cursor: pointer;
      position: relative;
      transition: all 0.2s ease;
      flex-shrink: 0;
    }

    .todo-checkbox:hover {
      border-color: #e94560;
    }

    .todo-checkbox:checked {
      background: #e94560;
      border-color: #e94560;
    }

    .todo-checkbox:checked::after {
      content: '‚úì';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: white;
      font-size: 14px;
      font-weight: bold;
    }

    .todo-text {
      flex: 1;
      color: #ddd;
      font-size: 1rem;
      transition: all 0.2s ease;
      word-break: break-word;
    }

    .todo-item.completed .todo-text {
      text-decoration: line-through;
      color: #666;
    }

    .delete-btn {
      background: transparent;
      border: none;
      color: #666;
      font-size: 1.25rem;
      cursor: pointer;
      padding: 4px 8px;
      border-radius: 6px;
      transition: all 0.2s ease;
      opacity: 0;
    }

    .todo-item:hover .delete-btn {
      opacity: 1;
    }

    .delete-btn:hover {
      color: #e94560;
      background: rgba(233, 69, 96, 0.1);
    }

    .todo-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 16px;
      padding-top: 16px;
      border-top: 1px solid #0f3460;
      flex-wrap: wrap;
      gap: 10px;
    }

    .todo-count {
      color: #888;
      font-size: 0.875rem;
    }

    .clear-btn {
      background: transparent;
      border: 1px solid #0f3460;
      border-radius: 8px;
      padding: 8px 14px;
      color: #888;
      font-size: 0.875rem;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .clear-btn:hover {
      border-color: #e94560;
      color: #e94560;
    }

    .clear-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .empty-state {
      text-align: center;
      padding: 40px 20px;
      color: #666;
    }

    .empty-state-icon {
      font-size: 3rem;
      margin-bottom: 10px;
    }
  </style>
</head>
<body>
  <div class="todo-widget">
    <div class="todo-header">
      <h1>Todo List</h1>
      <div class="todo-input-container">
        <input type="text" class="todo-input" id="todoInput" placeholder="What needs to be done?" />
        <button class="add-btn" id="addBtn">Add</button>
      </div>
    </div>

    <div class="todo-filters">
      <button class="filter-btn active" data-filter="all">All</button>
      <button class="filter-btn" data-filter="active">Active</button>
      <button class="filter-btn" data-filter="completed">Completed</button>
    </div>

    <ul class="todo-list" id="todoList"></ul>

    <div class="todo-footer">
      <span class="todo-count" id="todoCount">0 items left</span>
      <button class="clear-btn" id="clearBtn">Clear Completed</button>
    </div>
  </div>

  <script>
    (function() {
      // State
      let todos = [];
      let currentFilter = 'all';
      let nextId = 1;

      // DOM Elements
      const todoInput = document.getElementById('todoInput');
      const addBtn = document.getElementById('addBtn');
      const todoList = document.getElementById('todoList');
      const todoCount = document.getElementById('todoCount');
      const clearBtn = document.getElementById('clearBtn');
      const filterBtns = document.querySelectorAll('.filter-btn');

      // Add todo
      function addTodo() {
        const text = todoInput.value.trim();
        if (!text) return;

        todos.push({
          id: nextId++,
          text: text,
          completed: false
        });

        todoInput.value = '';
        render();
      }

      // Toggle todo completion
      function toggleTodo(id) {
        const todo = todos.find(t => t.id === id);
        if (todo) {
          todo.completed = !todo.completed;
          render();
        }
      }

      // Delete todo with animation
      function deleteTodo(id) {
        const item = document.querySelector(`[data-id="${id}"]`);
        if (item) {
          item.classList.add('deleting');
          setTimeout(() => {
            todos = todos.filter(t => t.id !== id);
            render();
          }, 300);
        }
      }

      // Clear completed todos
      function clearCompleted() {
        todos = todos.filter(t => !t.completed);
        render();
      }

      // Set filter
      function setFilter(filter) {
        currentFilter = filter;
        filterBtns.forEach(btn => {
          btn.classList.toggle('active', btn.dataset.filter === filter);
        });
        render();
      }

      // Get filtered todos
      function getFilteredTodos() {
        switch (currentFilter) {
          case 'active':
            return todos.filter(t => !t.completed);
          case 'completed':
            return todos.filter(t => t.completed);
          default:
            return todos;
        }
      }

      // Render
      function render() {
        const filtered = getFilteredTodos();
        const activeCount = todos.filter(t => !t.completed).length;
        const completedCount = todos.filter(t => t.completed).length;

        // Update count
        todoCount.textContent = `${activeCount} item${activeCount !== 1 ? 's' : ''} left`;

        // Update clear button
        clearBtn.disabled = completedCount === 0;

        // Render list
        if (filtered.length === 0) {
          let message = 'No todos yet. Add one above!';
          if (currentFilter === 'active') message = 'No active todos!';
          if (currentFilter === 'completed') message = 'No completed todos!';

          todoList.innerHTML = `
            <li class="empty-state">
              <div class="empty-state-icon">üìù</div>
              <div>${message}</div>
            </li>
          `;
          return;
        }

        todoList.innerHTML = filtered.map(todo => `
          <li class="todo-item ${todo.completed ? 'completed' : ''}" data-id="${todo.id}">
            <input type="checkbox" class="todo-checkbox" ${todo.completed ? 'checked' : ''} />
            <span class="todo-text">${escapeHtml(todo.text)}</span>
            <button class="delete-btn" title="Delete">√ó</button>
          </li>
        `).join('');

        // Add event listeners
        todoList.querySelectorAll('.todo-item').forEach(item => {
          const id = parseInt(item.dataset.id);
          const checkbox = item.querySelector('.todo-checkbox');
          const deleteBtn = item.querySelector('.delete-btn');

          checkbox.addEventListener('change', () => toggleTodo(id));
          deleteBtn.addEventListener('click', () => deleteTodo(id));
        });
      }

      // Escape HTML to prevent XSS
      function escapeHtml(text) {
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
      }

      // Event listeners
      addBtn.addEventListener('click', addTodo);

      todoInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') addTodo();
      });

      clearBtn.addEventListener('click', clearCompleted);

      filterBtns.forEach(btn => {
        btn.addEventListener('click', () => setFilter(btn.dataset.filter));
      });

      // Initial render
      render();
    })();
  </script>
</body>
</html>
